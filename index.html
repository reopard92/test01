<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CODE NAME: 49C</title>
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="TENNIS">
    <link rel="apple-touch-icon" href="./icon.png">
    
    <!-- External Libs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Link to external CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="loadingScreen">
    <div class="loader-text">SYSTEM INITIALIZING...</div>
    <div class="loader-bar"></div>
</div>

<div id="sideMenu" class="side-menu-overlay" onclick="closeSideMenu(event)">
    <div class="side-menu-content">
        <div class="menu-item active" onclick="selectAppMode('tennis')">üéæ TENNIS</div>
        <div class="menu-item" onclick="selectAppMode('game')">üéÆ GAME</div>
        <div class="menu-item" onclick="showMyPage()">üë§ MY PAGE</div>
    </div>
</div>

<div class="container">
    <header class="app-header">
        <div id="currentUserDisplay" class="user-status-display" onclick="showMyPage()">GUEST</div>
        <div class="header-btn left" onclick="manualReload()">‚Üª</div>
        <h1 id="pageTitle">MATCH INPUT</h1>
        <div class="subtitle">DEEP SPACE INTEGRATED SYSTEM</div>
        <div class="header-btn right" id="menuToggleBtn" onclick="toggleSideMenu()">‚â°</div>
    </header>
    
    <!-- TOP SECTION -->
    <div id="view-top" class="view-section">
        <div class="section-title">WEATHER FORECAST</div>
        <div id="weather-forecast" class="weather-container">
            <div class="weather-card"><div class="spinning">‚ùñ</div></div>
        </div>

        <div class="section-title">COURT NAVIGATION</div>
        <div class="sector-filter-area" style="text-align:center; margin-bottom:20px;">
            <select id="mapSectorSelect" class="sector-select" onchange="renderMapInfo(this.value)">
                <option value="-">SELECT SECTOR</option>
                <option value="MOGUSA">ÁôæËçâ„ÉÜ„Éã„Çπ„Ç¨„Éº„Éá„É≥</option>
                <option value="NERIMA">Á∑¥È¶¨„Çπ„ÉÜ„ÉÉ„Éó„Ç§„É≥</option>
            </select>
        </div>
        <div id="mapContainer">
            <div class="empty-map-state">
                WAITING FOR NAVI INPUT...
            </div>
        </div>
    </div>

    <!-- MY PAGE SECTION -->
    <div id="view-mypage" class="view-section">
        <div id="myPageContent"></div>
        <input type="file" id="avatarInput" hidden accept="image/*" onchange="handleAvatarUpload(this)">
    </div>

    <!-- MATCH INPUT SECTION -->
    <div id="view-match" class="view-section active">
        <div class="input-header-area">
            <div id="matchDate"></div>
            <select id="courtSelect" onchange="saveState()" disabled>
                <option value="-">-</option>
                <option value="Á∑¥È¶¨„Çπ„ÉÜ„ÉÉ„Éó„Ç§„É≥">Á∑¥È¶¨„Çπ„ÉÜ„ÉÉ„Éó„Ç§„É≥</option>
                <option value="ÁôæËçâ„ÉÜ„Éã„Çπ„Ç¨„Éº„Éá„É≥">ÁôæËçâ„ÉÜ„Éã„Çπ„Ç¨„Éº„Éá„É≥</option>
                <option value="„É¢„É™„Éë„Éº„ÇØ „ÉÜ„Éã„Çπ„Ç¨„Éº„Éá„É≥">„É¢„É™„Éë„Éº„ÇØ „ÉÜ„Éã„Çπ„Ç¨„Éº„Éá„É≥</option>
                <option value="ÁôΩÂ≠êÁî∫">ÁôΩÂ≠êÁî∫</option>
            </select>
            <div class="header-ctrl-area">
                 <button id="editBtn" class="btn-ctrl" onclick="toggleEditMode()">EDIT</button>
                 <button id="resetBtn" class="btn-ctrl" onclick="secureReset()" disabled>RESET</button>
            </div>
        </div>

        <div class="round-title">ROUND 01</div>
        <div class="player-inputs">
            <div class="input-group"><label>I</label><select id="r1_p1" class="player-select" onchange="updateSchedule('r1')" disabled></select></div>
            <div class="input-group"><label>II</label><select id="r1_p2" class="player-select" onchange="updateSchedule('r1')" disabled></select></div>
            <div class="input-group"><label>III</label><select id="r1_p3" class="player-select" onchange="updateSchedule('r1')" disabled></select></div>
            <div class="input-group"><label>IV</label><select id="r1_p4" class="player-select" onchange="updateSchedule('r1')" disabled></select></div>
            <div class="input-group"><label>V</label><select id="r1_p5" class="player-select" onchange="updateSchedule('r1')" disabled></select></div>
        </div>
        <table class="input-match-table">
            <thead><tr><th>No.</th><th>PAIR A</th><th>G</th><th></th><th>G</th><th>PAIR B</th><th>REST</th></tr></thead>
            <tbody id="r1_matchTableBody"></tbody>
        </table>

        <div class="round-title">ROUND 02</div>
        <div class="player-inputs">
            <div class="input-group"><label>I</label><select id="r2_p1" class="player-select" onchange="updateSchedule('r2')" disabled></select></div>
            <div class="input-group"><label>II</label><select id="r2_p2" class="player-select" onchange="updateSchedule('r2')" disabled></select></div>
            <div class="input-group"><label>III</label><select id="r2_p3" class="player-select" onchange="updateSchedule('r2')" disabled></select></div>
            <div class="input-group"><label>IV</label><select id="r2_p4" class="player-select" onchange="updateSchedule('r2')" disabled></select></div>
            <div class="input-group"><label>V</label><select id="r2_p5" class="player-select" onchange="updateSchedule('r2')" disabled></select></div>
        </div>
        <table class="input-match-table">
            <thead><tr><th>No.</th><th>PAIR A</th><th>G</th><th></th><th>G</th><th>PAIR B</th><th>REST</th></tr></thead>
            <tbody id="r2_matchTableBody"></tbody>
        </table>

        <button id="sendButton" class="btn-send" onclick="sendToSpreadsheet()" disabled>TRANSMIT DATA</button>
    </div>

    <!-- DASHBOARD SECTION -->
    <div id="view-dashboard" class="view-section">
        <div class="section-title">Ê¥ªÂãïÁä∂Ê≥Å„Çµ„Éû„É™„Éº</div>
        <div class="dashboard-grid">
            <div class="stat-card"><div class="stat-label">ÈñãÂÇ¨ÂõûÊï∞</div><div class="stat-value highlight" id="totalMissions">0</div></div>
            <div class="stat-card"><div class="stat-label">Á∑è„Ç≤„Éº„É†Êï∞</div><div class="stat-value" id="totalGames">0</div></div>
            <div class="stat-card"><div class="stat-label">Âπ≥Âùá„Ç≤„Éº„É†</div><div class="stat-value" id="avgGames">-</div></div>
        </div>
        <div class="chart-container">
            <canvas id="winRateChart"></canvas>
        </div>
        <div id="logsContainer"></div>
    </div>

    <!-- RANKING SECTION -->
    <div id="view-ranking" class="view-section">
        <div class="section-title">ÈÄöÁÆóÂÄã‰∫∫„É©„É≥„Ç≠„É≥„Ç∞</div>
        <table class="standard-table">
            <thead><tr><th>È†Ü‰Ωç</th><th>ÂêçÂâç</th><th>ÂãùÂà©Êï∞</th><th>ÂãùÁéá</th><th>MVP</th></tr></thead>
            <tbody id="leaderboardBody"></tbody>
        </table>
    </div>

    <!-- SCHEDULE SECTION -->
    <div id="view-schedule" class="view-section">
        <div class="section-title">MISSION SCHEDULE</div>
        <div id="scheduleList" class="schedule-list"></div>
    </div>

    <!-- GAME SECTION -->
    <div id="view-game" class="view-section">
        <div class="game-hero">
            <div class="game-tag">DEV PHASE 1</div>
            <h2>RESOURCE STRATEGY</h2>
            <p>1v1 TACTICAL CARD GAME</p>
        </div>

        <div class="section-title">MINI GAMES & TOOLS</div>
        <div class="game-grid">
            <div class="game-card" onclick="openSlotGame()">
                <div class="game-status live">NEW</div>
                <div class="game-icon">üé∞</div>
                <div class="game-card-title">SLOT MACHINE</div>
            </div>

            <div class="game-card" onclick="openCoinGame()">
                <div class="game-status live">LIVE</div>
                <div class="game-icon">ü™ô</div>
                <div class="game-card-title">COIN TOSS</div>
            </div>
        </div>
    </div>

</div>

<!-- FOOTER NAV -->
<nav id="bottomNav" class="bottom-nav">
    <button class="nav-item active" onclick="switchMainView('top')"><span class="nav-icon">üè†</span>TOP</button>
    <button class="nav-item" onclick="switchMainView('match')"><span class="nav-icon">üéæ</span>INPUT</button>
    <button class="nav-item" onclick="switchMainView('dashboard')"><span class="nav-icon">üìà</span>DATA</button>
    <button class="nav-item" onclick="switchMainView('ranking')"><span class="nav-icon">üëë</span>RANK</button>
    <button class="nav-item" onclick="switchMainView('schedule')"><span class="nav-icon">üìÖ</span>SCHEDULE</button>
</nav>

<!-- MODALS -->
<div id="slotGameModal" onclick="closeSlotGame(event)">
    <div class="modal-content" style="max-width:480px; text-align:center; border-color: #ffd700; background: #111;">
        <button class="close-btn" onclick="closeSlotGame(event)">√ó</button>
        <div class="modal-title" style="color: #ffd700;">CASINO SLOT</div>
        
        <div class="slot-payout-table">
            <span>777: 7777</span> | <span>üíé: 1000</span> | <span>üîî: 500</span> | <span>üçá: 300</span> | <span>üçí: 100</span>
        </div>

        <div class="slot-frame">
            <div class="slot-machine-container">
                <div class="reel-container"><div id="reel1" class="reel">7</div></div>
                <div class="reel-container"><div id="reel2" class="reel">7</div></div>
                <div class="reel-container"><div id="reel3" class="reel">7</div></div>
            </div>
            
            <div class="slot-lever-container" onclick="pullSlotLever()">
                <div class="slot-lever-base"></div>
                <div class="slot-lever-stick"><div class="slot-lever-knob"></div></div>
            </div>
        </div>

        <div style="display:flex; justify-content:center; gap:10px; margin-bottom:20px;">
            <button id="stop1" class="btn-ctrl" onclick="stopReel(0)" disabled>STOP</button>
            <button id="stop2" class="btn-ctrl" onclick="stopReel(1)" disabled>STOP</button>
            <button id="stop3" class="btn-ctrl" onclick="stopReel(2)" disabled>STOP</button>
        </div>

        <div id="slotMessage" style="color:#ffd700; font-weight:bold;">PULL THE LEVER!</div>
        <div style="margin-top:15px;">WALLET: <span id="slotWallet" style="color:#ffd700;">0</span></div>
    </div>
</div>

<div id="coinGameModal" onclick="closeCoinGame(event)">
    <div class="modal-content" style="max-width:300px; text-align:center;">
        <button class="close-btn" onclick="closeCoinGame(event)">√ó</button>
        <div class="modal-title">COIN TOSS</div>
        <div id="gameCoin" class="coin-large" onclick="playCoinToss()">TAP</div>
    </div>
</div>

<div id="loginModal">
    <div class="modal-content" style="text-align:center; max-width:320px;">
        <div class="modal-title">ACCESS LOGIN</div>
        <input type="number" id="loginPassInput" placeholder="PASSCODE" style="width:80%; padding:10px; background:rgba(0,0,0,0.5); border:1px solid #00ffff; color:#fff; font-size:1.2rem; margin-bottom:20px;">
        <button class="btn-send" onclick="attemptLogin()" style="width:100%; margin:0;">AUTHENTICATE</button>
    </div>
</div>

<div id="toast"></div>

<!-- Link to external JS -->
<script src="script.js"></script>

</body>
</html>
